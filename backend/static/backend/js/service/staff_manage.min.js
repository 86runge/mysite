define([],function(){return{init:function(){$("#add_staff").on("click",function(){$("#staff_manage_modal").find(".modal-title").text("添加用户"),$("#submit_add_staff").show(),$("#submit_update_staff").hide(),$("#staff_manage_modal").modal({backdrop:"static",keyboard:!1})}),$("#submit_add_staff").on("click",function(){e("add_staff",""),$("#form_staff_manage").submit()}),$(".J_update_staff").on("click",function(){var a=$(this).parents("tr").attr("data-id");$("#update_id").val(a),$.ajax({url:"/backend/staff_manage/",type:"post",data:{id:a,action:"get_staff",csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},dataType:"json",success:function(a){$("#id_nick").val(a.nick),$("#id_username").val(a.username),$("#id_password").attr("placeholder","需要修改密码请输入新密码"),$("#id_phone").val(a.phone),$("#id_department").val(a.department),$("#id_role").val(a.role),$("#id_superior").val(a.superior),$("#id_email").val(a.email),a.is_active?$("#is_active_yes").prop("checked",!0):$("#is_active_no").prop("checked",!0),$("#submit_add_staff").hide(),$("#submit_update_staff").show(),$("#staff_manage_modal").find(".modal-title").text("修改用户"),$("#staff_manage_modal").modal({backdrop:"static",keyboard:!1})},error:function(a){console.log("发生错误"),console.log(a)}})}),$("#submit_update_staff").on("click",function(){var a=$("#update_id").val();e("update_staff",a),$("#form_staff_manage").submit()});var e=function(e,t){var a=!0;t&&(a=!1),$("#form_staff_manage").validate({rules:{nick:{required:!0},username:{required:!0,isUsername:!0},password:{required:a,isPassword:!0},phone:{required:!0,isMobile:!0},email:{isEmail:!0},department:{required:!0},role:{required:!0}},messages:{nick:{required:"请输入员工姓名"},username:{required:"请输入登录名"},password:{required:"请输入登录密码"},phone:{required:"请输入员工电话"},department:{required:"请输入所属部门"},role:{required:"请输入所属角色"}},submitHandler:function(){var a=new FormData($("#form_staff_manage")[0]);a.append("action",e),a.append("id",t),a.append("csrfmiddlewaretoken",$("input[name=csrfmiddlewaretoken]").val()),console.log(a),$.ajax({url:"/backend/staff_manage/",type:"post",data:a,dataType:"json",contentType:!1,processData:!1,success:function(a){alert("操作成功"),$("#staff_manage_modal").modal("hide"),window.location.reload()},error:function(a){console.log("发生错误"),console.log(a)}})}})};$(".J_delete_staff").on("click",function(){var a=$(this).parents("tr").attr("data-id");$.ajax({url:"/backend/staff_manage/",type:"post",data:{id:a,action:"delete_staff",csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},dataType:"json",success:function(a){alert(a.msg),window.location.reload()},error:function(a){console.log("发生错误"),console.log(a)}})})}}});