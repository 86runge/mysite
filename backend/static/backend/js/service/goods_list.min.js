define(["datetimepicker"],function(){return{init:function(){$("#id_online_time").datetimepicker(),$("#id_offline_time").datetimepicker(),$("#id_photo").on("click",function(){$("#id_good_photo").click()}),$("#id_photo").blur(function(){$(this).val($("#id_good_photo").val())}),$("#add_good").on("click",function(){$(".modal-title").text("添加商品"),$("#submit_add_good").show(),$("#submit_update_good").hide(),$("#good_manage_modal").modal({backdrop:"static",keyboard:!1})}),$("#submit_add_good").on("click",function(){i("add_good",""),$("#form_good_manage").submit()}),$(".J_update_good").on("click",function(){var e=$(this).parents("tr").attr("data-id");$("#update_id").val(e),$.ajax({url:"/backend/goods_list/",type:"post",data:{id:e,action:"get_good",csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},dataType:"json",success:function(e){$("#id_name").val(e.name),$("#id_price").val(e.price),$("#id_bit").val(e.bit),$("#id_photo").attr("placeholder","需要修改商品主图的点击重新上传"),$("#id_preorder_limit").val(e.preorder_limit),$("#id_freight_pricing_method").val(e.freight_pricing_method),$("#id_delivery_time").val(e.delivery_time),$("#id_online_time").val(e.online_time),$("#id_offline_time").val(e.offline_time),$("#id_refund_rate").val(e.refund_rate),$("#id_note").val(e.note),$("#submit_add_good").hide(),$("#submit_update_good").show(),$("#good_manage_modal").find(".modal-title").text("修改用户"),$("#good_manage_modal").modal({backdrop:"static",keyboard:!1})},error:function(e){console.log("发生错误"),console.log(e)}})}),$("#submit_update_good").on("click",function(){var e=$("#update_id").val();i("update_good",e),$("#form_good_manage").submit()});var i=function(i,o){var e=!0;o&&(e=!1),$("#form_good_manage").validate({rules:{name:{required:!0},price:{required:!0,isPrice:!0},bit:{required:!0},photo:{required:e},preorder_limit:{required:!0,isNumber:!0},freight_pricing_method:{required:!0},delivery_time:{required:!0,isNumber:!0},online_time:{required:!0},offline_time:{required:!0},refund_rate:{required:!0}},messages:{name:{required:"请输入商品名"},price:{required:"请输入商品价格"},bit:{required:"请输入商品货号"},photo:{required:"请上传商品主图"},preorder_limit:{required:"预购数量限制"},freight_pricing_method:{required:"请输入运费计价方式"},delivery_time:{required:"请选择发货时间"},online_time:{required:"请选择上架时间"},offline_time:{required:"请选择下架时间"},refund_rate:{required:"请输入退款比率"}},submitHandler:function(){var e=new FormData($("#form_good_manage")[0]);e.append("action",i),e.append("id",o),e.append("csrfmiddlewaretoken",$("input[name=csrfmiddlewaretoken]").val()),$.ajax({url:"/backend/goods_list/",type:"post",data:e,dataType:"json",contentType:!1,processData:!1,success:function(e){alert("操作成功"),$("#staff_manage_modal").modal("hide"),window.location.reload()},error:function(e){console.log("发生错误"),console.log(e)}})}})};$(".J_delete_good").on("click",function(){var e=$(this).parents("tr").attr("data-id");$.ajax({url:"/backend/goods_list/",type:"post",data:{id:e,action:"delete_good",csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},dataType:"json",success:function(e){alert(e.msg),window.location.reload()},error:function(e){console.log("发生错误"),console.log(e)}})})}}});